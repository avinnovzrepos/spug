<div class="spug-container">
  <div class="clearfix">
    <h3>
      Request
      <button class="btn btn-primary pull-right" ui-sref="requisition">
        request
        <span class="fa fa-plus"> </span>
      </button>
    </h3>
  </div>
  <div class="widget">
    <uib-tabset active="active">
      <uib-tab index="0">
        <uib-tab-heading>
          <i class="glyphicon glyphicon-bell"></i> My Request!
        </uib-tab-heading>
        <table class="table table-condensed table-hover">
          <tr>
            <th> Date </th>
            <th> Request By </th>
            <th> Request To </th>
            <th> Items </th>
            <th> Status </th>
            <th ng-if="requeList.currUser.role !== 'admin'"></th>
          </tr>
          <tr ng-repeat="request in requeList.requestList">
            <td> {{request.updatedAt | date: 'short'}} </td>
            <td> {{request.createdBy.name}} </td>
            <td> {{request.source.name}} </td>
            <td>
              <ul>
                <li ng-repeat="item in request.items"> {{item.item.name}} - {{item.quantity}} </li>
              </ul>
            </td>
            <td>
              <label class="label" ng-class="{'label-warning' : request.status === 'pending'}">
                {{request.status}}
              </label>
            </td>
            <td ng-if="requeList.currUser.role !== 'admin'">
              <button class="btn btn-sm btn-danger" ng-click="requeList.cancel(request)"> cancel </button>
            </td>
          </tr>
        </table>
      </uib-tab>
      <uib-tab index="1">
        <uib-tab-heading>
          <i class="glyphicon glyphicon-bell"></i> Request By Others!
        </uib-tab-heading>
        <table class="table table-condensed table-hover">
          <tr>
            <th> Date </th>
            <th> Request By </th>
            <th> Plant </th>
            <th> Items </th>
            <th> Status </th>
            <th></th>
          </tr>
          <tr ng-repeat="otherRequest in requeList.otherRequestList">
            <td> {{otherRequest.updatedAt | date: 'short'}} </td>
            <td> {{otherRequest.createdBy.name}} </td>
            <td> {{otherRequest.destination.name}} </td>
            <td>
              <ul>
                <li ng-repeat="item in otherRequest.items"> {{item.item.name}} - {{item.quantity}}</li>
              </ul>
            </td>
            <td>
              <label class="label" ng-class="{'label-warning' : otherRequest.status === 'pending', 'label-success' : otherRequest.status === 'approved' || 'received'}">
                {{otherRequest.status}}
              </label>
            </td>
            <td>
              <div ng-if="otherRequest.status === 'pending'">
                <button class="btn btn-sm btn-success" ng-click="requeList.approve(otherRequest)"> accept </button>
                <button class="btn btn-sm btn-danger"> decline </button>
              </div>
            </td>
          </tr>
        </table>
      </uib-tab>
    </uib-tabset>
  </div>
</div>

